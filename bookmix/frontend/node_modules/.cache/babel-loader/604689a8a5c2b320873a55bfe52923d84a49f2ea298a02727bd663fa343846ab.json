{"ast":null,"code":"import { getCurrentUserId } from './userUtils.js';\nexport const getCartFromStorage = (userId = getCurrentUserId()) => {\n  if (!userId) return [];\n  try {\n    const raw = localStorage.getItem(`cart:${userId}`);\n    return raw ? JSON.parse(raw) : [];\n  } catch {\n    return [];\n  }\n};\nexport const saveCartToStorage = (cartItems, userId = getCurrentUserId()) => {\n  if (!userId) return;\n  localStorage.setItem(`cart:${userId}`, JSON.stringify(cartItems));\n};\nexport const addToCartStorage = (bookId, quantity = 1) => {\n  const userId = getCurrentUserId();\n  if (!userId) return null;\n  const cart = getCartFromStorage(userId);\n  const exists = cart.find(ci => ci.bookId === bookId);\n  const newCart = exists ? cart.map(ci => ci.bookId === bookId ? {\n    ...ci,\n    quantity: ci.quantity + quantity\n  } : ci) : [...cart, {\n    bookId,\n    quantity\n  }];\n  saveCartToStorage(newCart, userId);\n  return newCart;\n};\nexport const removeFromCartStorage = bookId => {\n  const userId = getCurrentUserId();\n  if (!userId) return null;\n  const cart = getCartFromStorage(userId);\n  const exists = cart.find(ci => ci.bookId === bookId);\n  if (!exists) return cart;\n  const newCart = exists.quantity <= 1 ? cart.filter(ci => ci.bookId !== bookId) : cart.map(ci => ci.bookId === bookId ? {\n    ...ci,\n    quantity: ci.quantity - 1\n  } : ci);\n  saveCartToStorage(newCart, userId);\n  return newCart;\n};","map":{"version":3,"names":["getCurrentUserId","getCartFromStorage","userId","raw","localStorage","getItem","JSON","parse","saveCartToStorage","cartItems","setItem","stringify","addToCartStorage","bookId","quantity","cart","exists","find","ci","newCart","map","removeFromCartStorage","filter"],"sources":["C:/Users/My/OneDrive/Документы/конспекты/документы к курсачу 4 курс/project/bookmix/frontend/src/utils/cartUtils.js"],"sourcesContent":["import { getCurrentUserId } from './userUtils.js';\r\n\r\nexport const getCartFromStorage = (userId = getCurrentUserId()) => {\r\n  if (!userId) return [];\r\n  try {\r\n    const raw = localStorage.getItem(`cart:${userId}`);\r\n    return raw ? JSON.parse(raw) : [];\r\n  } catch {\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const saveCartToStorage = (cartItems, userId = getCurrentUserId()) => {\r\n  if (!userId) return;\r\n  localStorage.setItem(`cart:${userId}`, JSON.stringify(cartItems));\r\n};\r\n\r\nexport const addToCartStorage = (bookId, quantity = 1) => {\r\n  const userId = getCurrentUserId();\r\n  if (!userId) return null;\r\n  const cart = getCartFromStorage(userId);\r\n  const exists = cart.find(ci => ci.bookId === bookId);\r\n  const newCart = exists\r\n    ? cart.map(ci =>\r\n        ci.bookId === bookId ? { ...ci, quantity: ci.quantity + quantity } : ci\r\n      )\r\n    : [...cart, { bookId, quantity }];\r\n  saveCartToStorage(newCart, userId);\r\n  return newCart;\r\n};\r\n\r\nexport const removeFromCartStorage = (bookId) => {\r\n  const userId = getCurrentUserId();\r\n  if (!userId) return null;\r\n  const cart = getCartFromStorage(userId);\r\n  const exists = cart.find(ci => ci.bookId === bookId);\r\n  if (!exists) return cart;\r\n  const newCart =\r\n    exists.quantity <= 1\r\n      ? cart.filter(ci => ci.bookId !== bookId)\r\n      : cart.map(ci =>\r\n          ci.bookId === bookId\r\n            ? { ...ci, quantity: ci.quantity - 1 }\r\n            : ci\r\n        );\r\n  saveCartToStorage(newCart, userId);\r\n  return newCart;\r\n};\r\n"],"mappings":"AAAA,SAASA,gBAAgB,QAAQ,gBAAgB;AAEjD,OAAO,MAAMC,kBAAkB,GAAGA,CAACC,MAAM,GAAGF,gBAAgB,CAAC,CAAC,KAAK;EACjE,IAAI,CAACE,MAAM,EAAE,OAAO,EAAE;EACtB,IAAI;IACF,MAAMC,GAAG,GAAGC,YAAY,CAACC,OAAO,CAAC,QAAQH,MAAM,EAAE,CAAC;IAClD,OAAOC,GAAG,GAAGG,IAAI,CAACC,KAAK,CAACJ,GAAG,CAAC,GAAG,EAAE;EACnC,CAAC,CAAC,MAAM;IACN,OAAO,EAAE;EACX;AACF,CAAC;AAED,OAAO,MAAMK,iBAAiB,GAAGA,CAACC,SAAS,EAAEP,MAAM,GAAGF,gBAAgB,CAAC,CAAC,KAAK;EAC3E,IAAI,CAACE,MAAM,EAAE;EACbE,YAAY,CAACM,OAAO,CAAC,QAAQR,MAAM,EAAE,EAAEI,IAAI,CAACK,SAAS,CAACF,SAAS,CAAC,CAAC;AACnE,CAAC;AAED,OAAO,MAAMG,gBAAgB,GAAGA,CAACC,MAAM,EAAEC,QAAQ,GAAG,CAAC,KAAK;EACxD,MAAMZ,MAAM,GAAGF,gBAAgB,CAAC,CAAC;EACjC,IAAI,CAACE,MAAM,EAAE,OAAO,IAAI;EACxB,MAAMa,IAAI,GAAGd,kBAAkB,CAACC,MAAM,CAAC;EACvC,MAAMc,MAAM,GAAGD,IAAI,CAACE,IAAI,CAACC,EAAE,IAAIA,EAAE,CAACL,MAAM,KAAKA,MAAM,CAAC;EACpD,MAAMM,OAAO,GAAGH,MAAM,GAClBD,IAAI,CAACK,GAAG,CAACF,EAAE,IACTA,EAAE,CAACL,MAAM,KAAKA,MAAM,GAAG;IAAE,GAAGK,EAAE;IAAEJ,QAAQ,EAAEI,EAAE,CAACJ,QAAQ,GAAGA;EAAS,CAAC,GAAGI,EACvE,CAAC,GACD,CAAC,GAAGH,IAAI,EAAE;IAAEF,MAAM;IAAEC;EAAS,CAAC,CAAC;EACnCN,iBAAiB,CAACW,OAAO,EAAEjB,MAAM,CAAC;EAClC,OAAOiB,OAAO;AAChB,CAAC;AAED,OAAO,MAAME,qBAAqB,GAAIR,MAAM,IAAK;EAC/C,MAAMX,MAAM,GAAGF,gBAAgB,CAAC,CAAC;EACjC,IAAI,CAACE,MAAM,EAAE,OAAO,IAAI;EACxB,MAAMa,IAAI,GAAGd,kBAAkB,CAACC,MAAM,CAAC;EACvC,MAAMc,MAAM,GAAGD,IAAI,CAACE,IAAI,CAACC,EAAE,IAAIA,EAAE,CAACL,MAAM,KAAKA,MAAM,CAAC;EACpD,IAAI,CAACG,MAAM,EAAE,OAAOD,IAAI;EACxB,MAAMI,OAAO,GACXH,MAAM,CAACF,QAAQ,IAAI,CAAC,GAChBC,IAAI,CAACO,MAAM,CAACJ,EAAE,IAAIA,EAAE,CAACL,MAAM,KAAKA,MAAM,CAAC,GACvCE,IAAI,CAACK,GAAG,CAACF,EAAE,IACTA,EAAE,CAACL,MAAM,KAAKA,MAAM,GAChB;IAAE,GAAGK,EAAE;IAAEJ,QAAQ,EAAEI,EAAE,CAACJ,QAAQ,GAAG;EAAE,CAAC,GACpCI,EACN,CAAC;EACPV,iBAAiB,CAACW,OAAO,EAAEjB,MAAM,CAAC;EAClC,OAAOiB,OAAO;AAChB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}